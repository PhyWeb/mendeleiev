<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le génie de Mendeleïev - page 7</title>
    <link rel="stylesheet" href="style.css">
    <script src="data.js"></script>
    <script src="game.js"></script>
</head>
<body>

    <header>
        <h2>Le génie de Mendeleïev - La continuité</h2>
    </header>

    <div class="main-container">
        
        <section class="game-area">
            
            <div class="question-box intro-text">
                <p class="consigne" style="font-size: 1.1em; text-align: center;">
                    Indiquez dans le tableau ci-dessous les <strong style="color: #FF0066;">numéros atomiques</strong> des gaz rares.
                </p>
            </div>

            <div class="grid-missing-col" id="grid-container"></div>

        </section>

    </div>

    <footer class="controls">
        <button class="btn" id="btn-verif" onclick="verifierReponse()">Valider</button>
        <div id="message-box"></div>
        <div class="nav-links">
            <a href="partie3_06.html" class="link-simple">&larr; Retour</a>
            <a href="partie3_08.html" id="btn-suite" class="btn" style="display:none;">Suite</a>
        </div>
    </footer>

    <script>
        // --- 1. CONSTRUCTION DE LA GRILLE ---
        const grid = document.getElementById('grid-container');

        // Helper : Ajoute une carte atomique (Affiche Z et Symbole)
        const addAtom = (id) => {
            const data = elementsData.find(e => e.id === id);
            if(data) {
                // Mode 'atomic' affiche le Z en haut à gauche (défini dans game.js)
                grid.appendChild(createCard(data, false, { mode: 'atomic' }));
            }
        };

        // Helper : Ajoute des espaces vides
        const addGap = (n) => {
            for(let i=0; i<n; i++) grid.appendChild(document.createElement('div'));
        };

        // Helper : Ajoute une carte Input pour les gaz rares inconnus
        const addInput = (inputId) => {
            // Astuce : On passe un objet temporaire avec id="?" pour l'affichage
            const fakeData = { id: "?" };
            // Mode 'inputAtomic' crée l'input et place l'ID au-dessus
            grid.appendChild(createCard(fakeData, false, { mode: 'inputAtomic', inputId: inputId }));
        };

        // --- Ligne 1 : H ...... ? ---
        addAtom("H");
        addGap(6);
        addInput("rep1");

        // --- Ligne 2 : Li -> F ... ? ---
        ["Li", "Be", "B", "C", "N", "O", "F"].forEach(id => addAtom(id));
        addInput("rep2");

        // --- Ligne 3 : Na -> Cl ... ? ---
        ["Na", "Mg", "Al", "Si", "P", "S", "Cl"].forEach(id => addAtom(id));
        addInput("rep3");


        // --- 2. VÉRIFICATION (Code original préservé) ---
        function verifierReponse() {
            const rep1 = document.getElementById('rep1').value.trim();
            const rep2 = document.getElementById('rep2').value.trim();
            const rep3 = document.getElementById('rep3').value.trim();
            
            const reponses = [rep1, rep2, rep3];
            const solutions = ["2", "10", "18"];
            
            let testrep = 0;

            for(let i=0; i<3; i++) {
                const input = document.getElementById(`rep${i+1}`);
                if(reponses[i] === solutions[i]) {
                    testrep++;
                    input.style.backgroundColor = "#d4edda"; // Vert clair
                    input.style.borderColor = "#28a745";
                } else {
                    input.style.backgroundColor = "#f8d7da"; // Rouge clair
                    input.style.borderColor = "#dc3545";
                }
            }

            const err = 3 - testrep;
            const msgBox = document.getElementById('message-box');
            const btnSuite = document.getElementById('btn-suite');

            if (testrep === 3) {
                msgBox.innerHTML = "Bien. Mais cela devient facile à ce stade de l'étude du tableau ! Et vous pouvez remarquer que la continuité des numéros atomiques est désormais parfaite. <br/>Vous pouvez passer à la suite.";
                msgBox.className = "msg-success";
                
                document.getElementById('btn-verif').disabled = true;
                // Désactivation des champs
                for(let i=1; i<=3; i++) document.getElementById(`rep${i}`).disabled = true;
                
                btnSuite.style.display = "inline-block";
            } else {
                msgBox.innerHTML = "Non ! Vous avez commis " + err + " erreur(s)<br/>Rappelez-vous le critère actuel de classement des éléments le long des lignes...";
                msgBox.className = "msg-error";
            }
        }
    </script>
</body>
</html>