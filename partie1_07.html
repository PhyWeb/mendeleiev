<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Placement de l'Hydrogène</title>
    <link rel="stylesheet" href="style.css">
    <script src="data.js"></script>
    <script src="game.js"></script>
</head>
<body>
    <header>
        <h2>Où placer l'Hydrogène ?</h2>
        <p>Etudiez ses propriétés pour lui trouver une position qui soit en accord avec les principes établis jusqu'ici (mais tous ces principes ne pourront pas être respectés car il est assez différent des autres).</p>
    </header>

    <div class="main-container">
        <section class="game-area">
            <div class="card-pool" id="pool" ondrop="drop(event)" ondragover="commonAllowDrop(event)" style="min-height:80px;"></div>
            <div class="periodic-grid" id="grid"></div>
        </section>

        <aside class="info-panel">
            <h3 style="text-align:center;">Détails</h3>
            <div style="text-align:center;"><span id="info-symbole" class="info-value">H</span></div>
            <span class="info-label">Masse</span><span class="info-value">1.0</span>
            <span class="info-label">Propriétés</span><span class="info-value">Gaz très léger. Explosif avec O2. Réagit avec Cl2.</span>
        </aside>
    </div>

    <footer class="controls">
        <button class="btn" onclick="validerH()">Vérifier la position de H</button>
        <div id="message-box"></div>
        <div class="nav-links">
             <a href="index.html" id="btn-fin" class="btn" style="display:none;">Retour accueil</a>
        </div>
    </footer>

    <script>
        const pool = document.getElementById('pool');
        const grid = document.getElementById('grid');

        // Création grille
        for(let i=0; i<32; i++) {
            let slot = document.createElement('div');
            slot.className = 'slot';
            slot.setAttribute('data-index', i);
            slot.ondrop = drop; 
            slot.ondragover = commonAllowDrop;
            grid.appendChild(slot);
        }

        // Init
        elementsData.forEach(el => {
            if(el.id === "H") {
                // Pour l'Hydrogène, on utilise la Factory (il est draggable et interactif)
                pool.appendChild(createCard(el));
            } else {
                // Pour les autres, création manuelle "simplifiée" (non interactifs, grisés)
                let card = document.createElement('div');
                card.className = 'element-card';
                card.id = el.id;
                card.textContent = el.id;
                
                // Styles spécifiques "désactivé"
                card.style.backgroundColor = "#eee";
                card.style.color = "#888";
                card.style.borderColor = "#ccc";
                
                let slot = grid.querySelector(`.slot[data-index='${el.pos}']`);
                if(slot) slot.appendChild(card);
            }
        });

        function drop(ev) {
            ev.preventDefault();
            let data = ev.dataTransfer.getData("text");
            // Seul H est autorisé à bouger sur cette page
            if(data !== "H") return; 
            
            let el = document.getElementById(data);
            if(ev.target.classList.contains('slot') && ev.target.children.length === 0) {
                ev.target.appendChild(el);
            } else if (ev.target.id === 'pool') pool.appendChild(el);
        }

        function validerH() {
            let hCard = document.getElementById("H");
            let parent = hCard.parentElement;
            let msg = document.getElementById('message-box');

            if(parent.classList.contains('slot')) {
                let idx = parseInt(parent.getAttribute('data-index'));
                if(idx === 0) {
                    hCard.className = "element-card correct";
                    msg.innerHTML = "Bravo ! H est dans la colonne 1.";
                    msg.className = "msg-success";
                    document.getElementById('btn-fin').style.display = 'inline-block';
                } else if (idx === 6 || idx === 14) {
                     hCard.className = "element-card incorrect";
                     msg.innerHTML = "Pas bête (famille 7), mais Mendeleïev a privilégié la masse : case 1.";
                     msg.className = "msg-partial";
                } else {
                    hCard.className = "element-card incorrect";
                    msg.innerHTML = "H est le plus léger des éléments (Case 1).";
                    msg.className = "msg-error";
                }
            } else {
                msg.innerHTML = "Placez l'Hydrogène dans la grille.";
            }
        }
    </script>
</body>
</html>